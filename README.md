# Nuxt Calendar App

Qiita の[この記事](https://qiita.com/Dragon-taro/items/03f322dee15b19c33613)に触発されて Google カレンダーのトレースを試みた。<br>

## 機能

- ソーシャルログイン（Google, Facebook, Github, テスト用アカウント）
- カレンダー
- スケジュールの登録、更新、削除

## 使用技術

- nuxt.js
- typescript(移行中のため部分的に js)
- firebase (firestore, auth, functions)
- jest(複雑な処理部分のみテストを作成)

## 雑記

- firebase の課金がこわいので、読み書き回数をカウントして上限を超えた場合は firestore の rule ではじくようにしている。
  - functions の定期実行で毎日読み書きカウントはリセットされる。
- Vuetify の Calendar コンポーネントを使えばスケジュールの登録もできるほぼ Google カレンダーなものが作れるが、学習目的のため自力で作成を試みた。
- 月単位でのプレビューとスケジュールの登録、更新、削除まではできた

## 苦労したところ
スケジュール部分で苦労した（月をまたぐなど、ある一定の期間をもつスケジュールをどうやってユーザーが今表示している月内の週にマッピングするか）
現状は以下のかたち（ユーザーの入力をカレンダーにマップするために、月、週で分割していく）

1. ユーザーの入力したスケジュールの期間を月ごとに分割して一つのオブジェクトにまとめ firestore に保存
2. firestore からスケジュール（カレンダーが表示している年のスケジュール）を取得し表示している月だけにフィルター
3. フィルターしたスケジュールを週ごとに分割（何曜〜何曜）のような形で格週ごとにスケジュールをマップしたオブジェクトに変換
4. そのオブジェクトをもとに各週ごとのスケジュールを描画

このやり方がいいのかどうか自信ない。。
ちゃんと読み込めてないのでおそらくだけど、、Vuetify のカレンダーでは、カレンダーの日単位でその日にスケジュールがあるかどうかを確認していくかたちになっているようだったので、やり方は全然違っていると思う。
